{"ast":null,"code":"var _jsxFileName = \"/Users/siggy/Allcode/tests/ol-acc-msg/frontend/src/components/InteractionContent/Notes.tsx\",\n  _s = $RefreshSig$();\nimport { useMutation } from \"@apollo/client\";\nimport React from \"react\";\nimport { toast } from \"react-toastify\";\nimport { ADD_NOTE, GET_A_INTERACTION } from \"../../client\";\nimport { AppContext } from \"../../context\";\nimport Heading from \"../Heading\";\nimport { Form } from \"./Form\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Notes = _ref => {\n  _s();\n  let {\n    notes\n  } = _ref;\n  const {\n    selectedId,\n    agent\n  } = React.useContext(AppContext);\n  const [addNote, {\n    loading\n  }] = useMutation(ADD_NOTE, {\n    update(cache, _ref2) {\n      let {\n        data: {\n          createNote\n        }\n      } = _ref2;\n      const result = cache.readQuery({\n        query: GET_A_INTERACTION,\n        variables: {\n          id: selectedId\n        }\n      });\n      if (result) {\n        cache.writeQuery({\n          query: GET_A_INTERACTION,\n          data: {\n            interaction: {\n              ...result.interaction,\n              notes: [...result.interaction.notes, {\n                ...createNote,\n                agent: {\n                  agent\n                }\n              }]\n            }\n          }\n        });\n      }\n    },\n    onCompleted() {\n      toast(\"Success: Added note\", {\n        type: \"success\"\n      });\n    },\n    onError() {\n      toast(\"Error: Failed to add note\", {\n        type: \"error\"\n      });\n    }\n  });\n  const handleAddNote = content => {\n    addNote({\n      variables: {\n        interactionId: selectedId,\n        content,\n        agentId: agent === null || agent === void 0 ? void 0 : agent.id\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pl-4 flex flex-col w-1/3\",\n    children: [/*#__PURE__*/_jsxDEV(Heading, {\n      id: \"notes\",\n      type: \"h2\",\n      defaultStyle: \"pb-2 grow-0\",\n      children: \"Notes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      className: \"flex flex-col grow overflow-auto mb-4\"\n      /** Adding tabIndex & a label to non-interactive element because it\n       * could be scrollable with a long list. */\n      // eslint-disable-next-line\n      ,\n      tabIndex: 0,\n      \"aria-labelledby\": \"notes\",\n      children: notes.map(note => {\n        var _note$agent, _note$agent2;\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          className: `mb-4 rounded p-3 bg-amber-100 \n                        max-w-prose mr-2 border border-amber-300`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex max-w-prose\",\n            children: note.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 25\n          }, this), (note === null || note === void 0 ? void 0 : (_note$agent = note.agent) === null || _note$agent === void 0 ? void 0 : _note$agent.name) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"italic font-semibold pt-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"sr-only\",\n              children: `- agent `\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 33\n            }, this), note === null || note === void 0 ? void 0 : (_note$agent2 = note.agent) === null || _note$agent2 === void 0 ? void 0 : _note$agent2.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 29\n          }, this)]\n        }, note.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grow-0\",\n      children: /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: handleAddNote,\n        title: \"Add Note\",\n        cta: \"Add note\",\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 9\n  }, this);\n};\n_s(Notes, \"u1svjGFktb41CQoJKMxdlbUpCRA=\", false, function () {\n  return [useMutation];\n});\n_c = Notes;\nexport default Notes;\nvar _c;\n$RefreshReg$(_c, \"Notes\");","map":{"version":3,"names":["useMutation","React","toast","ADD_NOTE","GET_A_INTERACTION","AppContext","Heading","Form","Notes","notes","selectedId","agent","useContext","addNote","loading","update","cache","data","createNote","result","readQuery","query","variables","id","writeQuery","interaction","onCompleted","type","onError","handleAddNote","content","interactionId","agentId","map","note","name"],"sources":["/Users/siggy/Allcode/tests/ol-acc-msg/frontend/src/components/InteractionContent/Notes.tsx"],"sourcesContent":["import { useMutation } from \"@apollo/client\";\nimport React from \"react\";\nimport { toast } from \"react-toastify\";\nimport { ADD_NOTE, GET_A_INTERACTION } from \"../../client\";\nimport { AnInteractionResponse } from \"../../client/types\";\nimport { AppContext } from \"../../context\";\nimport { Note } from \"../../types\";\nimport Heading from \"../Heading\";\nimport { Form } from \"./Form\";\n\ninterface Props {\n    notes: Note[];\n}\n\nconst Notes = ({ notes }: Props) => {\n    const { selectedId, agent } = React.useContext(AppContext);\n\n    const [addNote, { loading }] = useMutation(ADD_NOTE, {\n        update(cache, { data: { createNote } }) {\n            const result = cache.readQuery<AnInteractionResponse>({\n                query: GET_A_INTERACTION,\n                variables: { id: selectedId },\n            });\n            if (result) {\n                cache.writeQuery({\n                    query: GET_A_INTERACTION,\n                    data: {\n                        interaction: {\n                            ...result.interaction,\n                            notes: [\n                                ...result.interaction.notes,\n                                { ...createNote, agent: { agent } },\n                            ],\n                        },\n                    },\n                });\n            }\n        },\n        onCompleted() {\n            toast(\"Success: Added note\", { type: \"success\" });\n        },\n        onError() {\n            toast(\"Error: Failed to add note\", { type: \"error\" });\n        },\n    });\n\n    const handleAddNote = (content: string) => {\n        addNote({\n            variables: {\n                interactionId: selectedId,\n                content,\n                agentId: agent?.id,\n            },\n        });\n    };\n\n    return (\n        <div className=\"pl-4 flex flex-col w-1/3\">\n            <Heading id=\"notes\" type=\"h2\" defaultStyle=\"pb-2 grow-0\">\n                Notes\n            </Heading>\n            <ul\n                className=\"flex flex-col grow overflow-auto mb-4\"\n                /** Adding tabIndex & a label to non-interactive element because it\n                 * could be scrollable with a long list. */\n                // eslint-disable-next-line\n                tabIndex={0}\n                aria-labelledby=\"notes\"\n            >\n                {notes.map((note) => (\n                    <li\n                        key={note.id}\n                        className={`mb-4 rounded p-3 bg-amber-100 \n                        max-w-prose mr-2 border border-amber-300`}\n                    >\n                        <div className=\"flex max-w-prose\">{note.content}</div>\n                        {note?.agent?.name && (\n                            <div className=\"italic font-semibold pt-2\">\n                                <span className=\"sr-only\">{`- agent `}</span>\n                                {note?.agent?.name}\n                            </div>\n                        )}\n                    </li>\n                ))}\n            </ul>\n            <div className=\"grow-0\">\n                <Form\n                    onSubmit={handleAddNote}\n                    title=\"Add Note\"\n                    cta=\"Add note\"\n                    loading={loading}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport default Notes;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}